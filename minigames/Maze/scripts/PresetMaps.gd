class_name PresetMaps
extends RefCounted

# Preset maps for the maze minigame
# Legend:
#   '#' = Wall
#   '.' = Floor (walkable)
#   'S' = Start position
#   '1'-'5' = Answer spots (correct answers placed here in order)

# Map dimensions: 31 wide x 37 tall
const MAP_WIDTH = 31
const MAP_HEIGHT = 37

# Map 1: Winding path with clear progression
const MAP_1 = [
	"###############################",
	"#S............................#",
	"#.############################.#",
	"#.#..........................#.#",
	"#.#.########################.#.#",
	"#.#.#......................#1#.#",
	"#.#.#.######################.#.#",
	"#.#.#.#....................#.#.#",
	"#.#.#.#.##################.#.#.#",
	"#.#.#.#.#..................#.#.#.#",
	"#.#.#.#.#.################.#.#.#.#",
	"#.#.#.#.#.#................#2#.#.#",
	"#.#.#.#.#.#.##############.#.#.#.#",
	"#.#.#.#.#.#.#............#.#.#.#.#",
	"#.#.#.#.#.#.#.##########.#.#.#.#.#",
	"#.#.#.#.#.#.#.#........#3#.#.#.#.#",
	"#.#.#.#.#.#.#.#.######.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#....#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#.##.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#4#.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.##.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#....#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.######.#.#.#.#.#.#",
	"#.#.#.#.#.#.#........#.#.#.#.#.#",
	"#.#.#.#.#.#.##########.#.#.#.#.#",
	"#.#.#.#.#.#............#.#.#.#.#",
	"#.#.#.#.#.############.#.#.#.#.#",
	"#.#.#.#.#................#.#.#.#",
	"#.#.#.#.##################.#.#.#",
	"#.#.#.#....................#.#.#",
	"#.#.#.######################.#.#",
	"#.#.#5........................#.#",
	"#.#.##########################.#",
	"#.#..........................#.#",
	"#.############################.#",
	"#.............................#",
	"###############################",
]

# Map 2: Spiral path
const MAP_2 = [
	"###############################",
	"#S............................#",
	"#.############################.#",
	"#.#..........................#.#",
	"#.#.########################.#.#",
	"#.#.#......................#1#.#",
	"#.#.#.######################.#.#",
	"#.#.#.#....................#.#.#",
	"#.#.#.#.##################.#.#.#",
	"#.#.#.#.#..................#.#.#.#",
	"#.#.#.#.#.################.#.#.#.#",
	"#.#.#.#.#.#................#2#.#.#",
	"#.#.#.#.#.#.##############.#.#.#.#",
	"#.#.#.#.#.#.#............#.#.#.#.#",
	"#.#.#.#.#.#.#.##########.#.#.#.#.#",
	"#.#.#.#.#.#.#.#........#3#.#.#.#.#",
	"#.#.#.#.#.#.#.#.######.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#....#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#.##.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#4#.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.##.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#....#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.######.#.#.#.#.#.#",
	"#.#.#.#.#.#.#........#.#.#.#.#.#",
	"#.#.#.#.#.#.##########.#.#.#.#.#",
	"#.#.#.#.#.#............#.#.#.#.#",
	"#.#.#.#.#.############.#.#.#.#.#",
	"#.#.#.#.#................#.#.#.#",
	"#.#.#.#.##################.#.#.#",
	"#.#.#.#....................#.#.#",
	"#.#.#.######################.#.#",
	"#.#.#5........................#.#",
	"#.#.##########################.#",
	"#.#..........................#.#",
	"#.############################.#",
	"#.............................#",
	"###############################",
]

# Map 3: Zigzag path
const MAP_3 = [
	"###############################",
	"#S............................#",
	"#.############################.#",
	"#.#..........................#.#",
	"#.#.########################.#.#",
	"#.#.#......................#1#.#",
	"#.#.#.######################.#.#",
	"#.#.#.#....................#.#.#",
	"#.#.#.#.##################.#.#.#",
	"#.#.#.#.#..................#.#.#.#",
	"#.#.#.#.#.################.#.#.#.#",
	"#.#.#.#.#.#................#2#.#.#",
	"#.#.#.#.#.#.##############.#.#.#.#",
	"#.#.#.#.#.#.#............#.#.#.#.#",
	"#.#.#.#.#.#.#.##########.#.#.#.#.#",
	"#.#.#.#.#.#.#.#........#3#.#.#.#.#",
	"#.#.#.#.#.#.#.#.######.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#....#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#.##.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.#4#.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#.##.#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.#....#.#.#.#.#.#.#",
	"#.#.#.#.#.#.#.######.#.#.#.#.#.#",
	"#.#.#.#.#.#.#........#.#.#.#.#.#",
	"#.#.#.#.#.#.##########.#.#.#.#.#",
	"#.#.#.#.#.#............#.#.#.#.#",
	"#.#.#.#.#.############.#.#.#.#.#",
	"#.#.#.#.#................#.#.#.#",
	"#.#.#.#.##################.#.#.#",
	"#.#.#.#....................#.#.#",
	"#.#.#.######################.#.#",
	"#.#.#5........................#.#",
	"#.#.##########################.#",
	"#.#..........................#.#",
	"#.############################.#",
	"#.............................#",
	"###############################",
]

# Get all maps as an array
static func get_all_maps() -> Array:
	return [MAP_1, MAP_2, MAP_3]

# Get a specific map by index (0-2)
static func get_map(index: int) -> Array:
	var maps = get_all_maps()
	return maps[index % maps.size()]

# Get a random map
static func get_random_map() -> Array:
	var maps = get_all_maps()
	return maps[randi() % maps.size()]

# Parse a map string array into maze data
# Returns: { "maze": 2D array, "start": Vector2i, "answer_spots": Array[Vector2i] }
static func parse_map(map_strings: Array) -> Dictionary:
	var maze: Array = []
	var start_pos := Vector2i(1, 1)
	var answer_spots: Array = []  # Index 0 = spot for Q1, etc.

	# Initialize answer_spots with 5 empty positions
	for i in range(5):
		answer_spots.append(Vector2i(-1, -1))

	for y in range(map_strings.size()):
		var row: Array = []
		var line: String = map_strings[y]

		for x in range(line.length()):
			var char = line[x]

			match char:
				'#':
					row.append(0)  # Wall
				'.':
					row.append(1)  # Floor
				'S':
					row.append(1)  # Floor (start position)
					start_pos = Vector2i(x, y)
				'1', '2', '3', '4', '5':
					row.append(1)  # Floor (answer spot)
					var spot_index = int(char) - 1
					answer_spots[spot_index] = Vector2i(x, y)
				_:
					row.append(0)  # Default to wall

		maze.append(row)

	return {
		"maze": maze,
		"start": start_pos,
		"answer_spots": answer_spots,
		"width": MAP_WIDTH,
		"height": MAP_HEIGHT
	}
